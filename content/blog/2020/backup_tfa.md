---toml
date = "2020-05-18T18:32:56-04:00"
title = "Backing Up Two-Factor Authentication Keys"

---

Two-factor authentication used to be required only for "high security" environments, like the millitary or banking. Usually in the form of a [physical "key fob"](https://en.wikipedia.org/wiki/RSA_SecurID), it was a dedicated "something you have" as the second factor. And then, in the early 2010s, Google released their [Google Authenticator App](https://en.wikipedia.org/wiki/Google_Authenticator), using your phone as the "second factor". Since its early versions were open source, its core code generation algorithm, [ToTP](https://en.wikipedia.org/wiki/Time-based_One-time_Password_algorithm), was eventually formalized in [RFC 6238](https://tools.ietf.org/html/rfc6238) and gained wide adoption.

The core problem of that "something you have" as a second factor is that it can be lost, or has to be replaced, both of which often happens with cellphones. What can also happen is that the [ToTP App has a bug and wipes out your keys](https://news.ycombinator.com/item?id=6325760), [something that happened in an early version of Google Authentication](https://www.androidpolice.com/2012/03/22/psa-googles-authenticator-updated-to-v2-except-its-a-brand-new-app-and-you-need-to-install-it-to-get-future-updates-old-one-is-dead/).

The recovery process varies from one site using ToTP to another, though it usually involves using some "recovery codes" you should keep in a safe place. This was fine when a user only had only a handful of two-factor protected accounts, but nowadays, as two-factor is becoming mandatory in many sites, even for [just downloading a free game](https://www.polygon.com/2020/4/28/21240024/epic-games-store-two-factor-authentication-2fa-free-games), recovering dozens of accounts can become tedious.

So, should there be a way to backup and synchronize those two-factor keys? In its original physical key fob form, part of its high security is that it was not only physical, but almost impossible to duplicate. If you could transfer and copy your "software key fobs", then you add the additional risk that somebody could steal your keys and your password. Still, a few two-factor apps offered to backup and sync your keys, encrypted with another password, for example [Authy](https://authy.com/) and [Microsoft Authenticator](https://www.microsoft.com/en-us/account/authenticator), and now even some password managers like [Bitwarden](https://bitwarden.com/), [LastPass](https://www.lastpass.com/two-factor-authentication) and [1Password](https://1password.com/).

This does raise the issue of "vendor lock-in", as in the keys stored in one two-factor authenticator app may not be transferable to another app. While this could be done by design to make it difficult to extract the codes from a device, tying something that valuable in an app that could charge a subscription and increase its pricing at any time is quite a risk. While Authy is still free, it is still closed-source and some of us don't want to trust its business model. So, some code was developed to [extract Authy keys from its desktop app](https://gist.github.com/gboudreau/94bb0c11a6209c82418d01a59d958c93). I used this to copy my ToTP keys to another password manager for safekeeping.
