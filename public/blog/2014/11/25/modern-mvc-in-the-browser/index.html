<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->
	<head>
		<meta charset="utf-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
                <title>Modern MVC in the Browser - Benad's Web Site</title>
		<meta name="description" content=""/>
		<meta name="viewport" content="width=device-width"/>
		<link rel="stylesheet" href="/css/bootstrap.css"/>
		<link rel="stylesheet" href="/css/bootstrap-responsive.css"/>
		<link rel="stylesheet" href="/css/main.css"/>
		<link rel="alternate" type="application/rss+xml" title="RSS" href="//feeds.feedburner.com/benad">
		<script src="/js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
	</head>
	<body>
            <!--[if lt IE 7]>
		<p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/"> upgrade your browser</a> to improve your experience.</p>
                <![endif]-->
		<div class="container">

<div class="row">
        <h1 class="title">Benad's Web Site</h1>
        <h2 class="pageheader">Modern MVC in the Browser</h2>
</div>
<div class="row">
        <div class="span2 pull-right sidebar">
                <p><a href="/index.html">Home</a></p>
                <p><a href="/blog">Blog</a></p>
                <p><a href="/me.html">About Me</a></p>
                <p><a href="/meta.html">About This Site</a></p>
                <p><a href="/articles.html">Articles</a></p>
                <p><a href="/links.html">Links</a></p>
        </div>

        <div class="span8 offset2">
                <p>A few months ago, I started learning the <a href="https://angularjs.org/">AngularJS</a> framework for web development. It is a quite clever framework that allows you to "augment" your HTML with markup to map placeholders with elements in your object model. It reminded me of <a href="https://en.wikipedia.org/wiki/JavaServer_Pages">JSP</a> and markup-based SWING frameworks <a href="http://blog.benad.me/blog/2005/9/8/bad-mvc-good-mvc.html">I used a decade ago</a>. Since then, though, I realized that this template-based approach has quite a few limitations that bother me. First, as it is based on templates, it doesn't handle well highly dynamic elements that generate markup based on context. Second, complex, many-to-many mappings between the view and the model are difficult to express. For example, it is difficult to express a value placeholder that is the sum of multiple elements in the models without having to resort calling a custom function, or having the change in the view trigger the corresponding change in multiple locations in the model without, again, resorting to a custom function. Third, it is a <em>framework</em> that needs to keep track of the model/view mapping, so it is all-encompassing and heavy in configuration.</p>

<p>So, let's break down the problem and look individually at the view, model and controller as separate modules, and see if there could be a better, more "modern" approach.</p>

<p>The biggest problem with the "model" in JavaScript is that it lacks safely hiding properties as functions, as done natively in C# for example, or manually through "getter" and "setter" functions in <a href="https://en.wikipedia.org/wiki/JavaBeans">JavaBeans</a>. Because of that, it becomes difficult to take any normal object and add a layer on top of it that would implement an <a href="https://en.wikipedia.org/wiki/Observer_pattern">observer pattern</a> automatically. Instead, you can use something like the model implementation of <a href="http://backbonejs.org/">Backbone.js</a> that fully hides the model behind a get/set interface that can automatically trigger change events to listener objects. It may not be elegant, but it works well.</p>

<p>For the "view", HTML development doesn't support well the concept of a "custom control" or "custom widget" in other GUIs. The view is mostly static, and JavaScript can change the DOM to some extent, and at high cost. In contrast, other GUI systems are based around rendering controls ("GUI controls", not to be confused with the controller in MVC) on a canvas, and the compositing engine takes care of rendering on screen only the visible and changed elements. A major advantage of that approach is that each control can render in any way it pleases without having to be aware of the lower-level rendering engine, be it pixels, vectors or HTML. You could simulate a full refresh of the DOM each time something (model or controller) changes the GUI in HTML, but the performance would be abysmal. Hence, the <a href="https://facebook.github.io/react/">React</a> library from Facebook and Instagram, which supports render-based custom controls but using a "virtual DOM", akin to "<a href="https://en.wikipedia.org/wiki/Mask_%28computing%29#Image_masks">bitmasks</a>" in traditional GUIs, so that only effective DOM changes are applied.</p>

<p>Finally, for the "controller", the biggest issue is how to have both the model and the view update each other automatically, on top of the usual business logic in the controller, without creating cyclic loops. <a href="https://facebook.github.io/react/">React</a>'s approach, named <a href="http://facebook.github.io/flux/docs/overview.html">Flux</a>, is a design pattern where you always let events flow from the model to the view, and never (directly) in the other direction. My gripe with that is that it is merely a design pattern that cannot be enforced. This reminds me of the dangers of using the <a href="http://msdn.microsoft.com/en-us/library/ms741870%28v=vs.110%29.aspx">WPF threading model</a> as a means to avoid concurrency issues: Forget to use the event dispatcher a single time, and you will create highly difficult to debug crashes. A new approach, called <a href="https://en.wikipedia.org/wiki/Functional_reactive_programming">functional reactive programming</a> is kind of like what <a href="https://en.wikipedia.org/wiki/Dependency_injection">dependency injection</a> did for module integration, but for events. Essentially it is a functional way of manipulating <em>channels</em> of events between producers and consumers outside of the code of each producer and consumer. This may sound quite an overhead compared to the inline and prescriptive approach of <a href="http://facebook.github.io/flux/docs/overview.html">Flux</a>, but as soon as you build a web page heavy on asynchronous callbacks and events coming from outside the page, having all of that "glue" in a single location is a great benefit. An implementation of FRP for JavaScript, <a href="https://baconjs.github.io/">Bacon.js</a>, has a <a href="http://abesto.net/bacon-js-on-the-server/">great example</a> of how FRP greatly reduces those countless nested callbacks that are commonplace in web and <a href="http://www.nodejs.org/">Node</a> development.</p>

<p>Combined, <a href="http://backbonejs.org/">Backbone.js</a>, <a href="https://facebook.github.io/react/">React</a> and <a href="https://baconjs.github.io/">Bacon.js</a> offer a compelling alternative to control- and template-heavy browser MVC frameworks, and at minimum prevent you from being "locked-in" a complex and difficult to replace framework.</p>

                <p>Published on November 25, 2014 at 20:44 EST</p>
                <p>Older post: <a href="https://benad.me/blog/2014/10/27/a-tale-of-two-shells">A Tale of Two Shells</a></p>
                <p>Newer post: <a href="https://benad.me/blog/2014/12/29/final-fantasy-vii-a-late-review">Final Fantasy VII, a Late Review</a></p>
        </div>
        <div id="disqus_thread" class="span8 offset2"></div>
</div>
			<footer>
				<hr/>
				<p>Benad's Web Site by Benoit Nadeau is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/2.5/ca/">Creative Commons Attribution-Share Alike 2.5 Canada License</a></p>
			</footer>
		</div>
		<script src="/js/vendor/jquery-1.9.1.min.js"></script>
		<script src="/js/vendor/bootstrap.min.js"></script>
		<script src="/js/main.js"></script>
	</body>
</html>

